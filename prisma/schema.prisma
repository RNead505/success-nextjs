generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model activity_logs {
  id        String   @id
  userId    String
  action    String
  entity    String
  entityId  String?
  details   String?
  ipAddress String?
  userAgent String?
  createdAt DateTime @default(now())
  users     users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([action])
  @@index([createdAt])
  @@index([entity])
  @@index([userId])
}

model bookmarks {
  id           String   @id
  userId       String
  articleId    String
  articleTitle String
  articleUrl   String
  articleImage String?
  createdAt    DateTime @default(now())
  users        users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, articleId])
  @@index([userId])
}

model bulk_actions {
  id             String     @id
  userId         String
  action         String
  entity         String
  entityIds      String[]
  status         BulkStatus @default(PENDING)
  totalItems     Int
  processedItems Int        @default(0)
  errors         String[]   @default([])
  startedAt      DateTime?
  completedAt    DateTime?
  createdAt      DateTime   @default(now())
  users          users      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([userId])
}

model campaign_contacts {
  id         String    @id
  campaignId String
  contactId  String
  status     String    @default("pending")
  sentAt     DateTime?
  openedAt   DateTime?
  clickedAt  DateTime?
  createdAt  DateTime  @default(now())
  campaigns  campaigns @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  contacts   contacts  @relation(fields: [contactId], references: [id], onDelete: Cascade)

  @@unique([campaignId, contactId])
}

model campaigns {
  id                String              @id
  name              String
  subject           String
  status            CampaignStatus      @default(DRAFT)
  templateId        String?
  scheduledAt       DateTime?
  sentAt            DateTime?
  totalSent         Int                 @default(0)
  totalOpened       Int                 @default(0)
  totalClicked      Int                 @default(0)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  campaign_contacts campaign_contacts[]
  email_templates   email_templates?    @relation(fields: [templateId], references: [id])
  drip_emails       drip_emails[]
}

model categories {
  id          String       @id
  name        String
  slug        String       @unique
  description String?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  wordpressId Int?         @unique
  color       String?
  icon        String?
  order       Int          @default(0)
  parentId    String?
  posts       posts[]      @relation("PostCategories")
  parent      categories?  @relation("CategoryHierarchy", fields: [parentId], references: [id], onDelete: SetNull)
  children    categories[] @relation("CategoryHierarchy")

  @@index([slug])
  @@index([wordpressId])
  @@index([order])
}

model comments {
  id          String        @id
  postId      String
  postTitle   String
  author      String
  authorEmail String
  authorUrl   String?
  content     String
  status      CommentStatus @default(PENDING)
  ipAddress   String?
  userAgent   String?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime

  @@index([authorEmail])
  @@index([postId])
  @@index([status])
}

model contacts {
  id                String              @id
  email             String              @unique
  firstName         String?
  lastName          String?
  phone             String?
  company           String?
  tags              String[]
  status            ContactStatus       @default(ACTIVE)
  source            String?
  notes             String?
  lastContactedAt   DateTime?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  campaign_contacts campaign_contacts[]
  email_logs        email_logs[]

  @@index([email])
  @@index([status])
}

model content_analytics {
  id             String   @id
  contentType    String
  contentId      String
  contentSlug    String
  contentTitle   String
  views          Int      @default(0)
  uniqueVisitors Int      @default(0)
  avgTimeOnPage  Int      @default(0)
  bounceRate     Float    @default(0.0)
  socialShares   Int      @default(0)
  comments       Int      @default(0)
  bookmarks      Int      @default(0)
  date           DateTime @default(now())
  createdAt      DateTime @default(now())
  updatedAt      DateTime
  metadata       String?

  @@unique([contentType, contentId, date])
  @@index([contentSlug])
  @@index([contentType])
  @@index([date])
}

model drip_emails {
  id         String    @id
  campaignId String
  name       String
  subject    String
  content    String
  delayDays  Int       @default(0)
  order      Int
  createdAt  DateTime  @default(now())
  updatedAt  DateTime
  campaigns  campaigns @relation(fields: [campaignId], references: [id], onDelete: Cascade)
}

model editorial_calendar {
  id            String          @id
  title         String
  contentType   ContentType     @default(ARTICLE)
  assignedToId  String?
  categoryId    String?
  status        EditorialStatus @default(IDEA)
  scheduledDate DateTime?
  publishDate   DateTime?
  deadline      DateTime?
  priority      Priority        @default(MEDIUM)
  notes         String?
  wordpressId   String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime
  users         users?          @relation(fields: [assignedToId], references: [id])

  @@index([assignedToId])
  @@index([scheduledDate])
  @@index([status])
}

model email_logs {
  id           String    @id
  contactId    String
  subject      String
  content      String
  status       String
  sentAt       DateTime  @default(now())
  openedAt     DateTime?
  clickedAt    DateTime?
  bouncedAt    DateTime?
  errorMessage String?
  contacts     contacts  @relation(fields: [contactId], references: [id], onDelete: Cascade)

  @@index([contactId])
  @@index([status])
}

model email_templates {
  id        String      @id
  name      String
  subject   String
  content   String
  isDefault Boolean     @default(false)
  createdAt DateTime    @default(now())
  updatedAt DateTime
  campaigns campaigns[]
}

model magazine_subscriptions {
  id               String        @id
  subscriptionId   String        @unique
  cwSubscriptionId String?
  shippingAddress  Json
  status           String        @default("active")
  createdAt        DateTime      @default(now())
  updatedAt        DateTime
  subscriptions    subscriptions @relation(fields: [subscriptionId], references: [id], onDelete: Cascade)

  @@index([subscriptionId])
}

model magazines {
  id            String   @id
  title         String
  slug          String   @unique
  publishedText String
  description   String?
  pdfUrl        String
  coverImageUrl String?
  fileSize      Int
  createdAt     DateTime @default(now())
  updatedAt     DateTime

  @@index([slug])
}

model media {
  id         String   @id
  filename   String
  url        String
  mimeType   String
  size       Int
  width      Int?
  height     Int?
  alt        String?
  uploadedBy String
  createdAt  DateTime @default(now())
  caption    String?
}

model newsletter_subscribers {
  id             String           @id
  email          String           @unique
  status         SubscriberStatus @default(ACTIVE)
  subscribedAt   DateTime         @default(now())
  unsubscribedAt DateTime?
  createdAt      DateTime         @default(now())
  updatedAt      DateTime

  @@index([email])
  @@index([status])
}

model order_items {
  id          String   @id
  orderId     String
  productId   String
  productName String
  quantity    Int
  price       Decimal  @db.Decimal(10, 2)
  total       Decimal  @db.Decimal(10, 2)
  createdAt   DateTime @default(now())
  orders      orders   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  products    products @relation(fields: [productId], references: [id])

  @@index([orderId])
  @@index([productId])
}

model orders {
  id              String        @id
  orderNumber     String        @unique
  userId          String?
  userName        String
  userEmail       String
  total           Decimal       @db.Decimal(10, 2)
  subtotal        Decimal       @db.Decimal(10, 2)
  tax             Decimal       @default(0) @db.Decimal(10, 2)
  shipping        Decimal       @default(0) @db.Decimal(10, 2)
  discount        Decimal       @default(0) @db.Decimal(10, 2)
  status          OrderStatus   @default(PENDING)
  paymentMethod   String
  paymentId       String?
  shippingAddress String?
  billingAddress  String?
  notes           String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime
  order_items     order_items[]

  @@index([createdAt])
  @@index([orderNumber])
  @@index([status])
  @@index([userId])
}

model page_views {
  id           String   @id
  userId       String?
  sessionId    String?
  articleId    String
  articleTitle String
  articleUrl   String
  viewedAt     DateTime @default(now())
  ipAddress    String?
  userAgent    String?

  @@index([articleId])
  @@index([sessionId])
  @@index([userId])
  @@index([viewedAt])
}

model pay_links {
  id               String        @id
  userId           String
  title            String
  description      String?
  amount           Decimal       @db.Decimal(10, 2)
  currency         String        @default("USD")
  slug             String        @unique
  stripePriceId    String?
  stripeProductId  String?
  status           PayLinkStatus @default(ACTIVE)
  expiresAt        DateTime?
  maxUses          Int?
  currentUses      Int           @default(0)
  requiresShipping Boolean       @default(false)
  customFields     Json?
  metadata         Json?
  createdAt        DateTime      @default(now())
  updatedAt        DateTime
  users            users         @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([slug])
  @@index([status])
  @@index([userId])
}

model pages {
  id             String     @id
  title          String
  slug           String     @unique
  content        String
  status         PostStatus @default(DRAFT)
  publishedAt    DateTime?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  seoTitle       String?
  seoDescription String?
  wordpressId    Int?       @unique
  template       String?
  parentId       String?
  order          Int        @default(0)

  @@index([slug])
  @@index([wordpressId])
}

model paywall_config {
  id                 String   @id
  freeArticleLimit   Int      @default(3)
  resetPeriodDays    Int      @default(30)
  enablePaywall      Boolean  @default(true)
  bypassedCategories String[]
  bypassedArticles   String[]
  popupTitle         String   @default("You've reached your free article limit")
  popupMessage       String
  ctaButtonText      String   @default("Subscribe Now")
  createdAt          DateTime @default(now())
  updatedAt          DateTime
}

model podcasts {
  id          String     @id
  title       String
  slug        String     @unique
  description String?
  audioUrl    String
  thumbnail   String?
  duration    Int?
  status      PostStatus @default(DRAFT)
  publishedAt DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  wordpressId Int?       @unique

  @@index([slug])
  @@index([wordpressId])
}

model posts {
  id                   String           @id
  title                String
  slug                 String           @unique
  content              String
  excerpt              String?
  featuredImage        String?
  featuredImageAlt     String?
  featuredImageCaption String?
  status               PostStatus       @default(DRAFT)
  authorId             String
  publishedAt          DateTime?
  createdAt            DateTime         @default(now())
  updatedAt            DateTime         @updatedAt
  seoTitle             String?
  seoDescription       String?
  metaKeywords         String?
  canonicalUrl         String?
  readTime             Int?
  views                Int              @default(0)
  customExcerpt        Boolean          @default(false)
  wordpressId          Int?             @unique
  wordpressSlug        String?
  wordpressAuthor      String?
  users                users            @relation(fields: [authorId], references: [id], onDelete: Cascade)
  categories           categories[]     @relation("PostCategories")
  tags                 tags[]           @relation("PostTags")
  post_revisions       post_revisions[]

  @@index([publishedAt])
  @@index([slug])
  @@index([status])
  @@index([wordpressId])
}

model post_revisions {
  id               String   @id
  postId           String
  title            String
  content          String
  excerpt          String?
  featuredImage    String?
  featuredImageAlt String?
  status           String
  seoTitle         String?
  seoDescription   String?
  authorId         String
  authorName       String
  changeNote       String?
  createdAt        DateTime @default(now())
  posts            posts    @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId])
  @@index([createdAt])
}

model products {
  id          String          @id
  name        String
  slug        String          @unique
  description String?
  price       Float
  salePrice   Float?
  sku         String?         @unique
  imageUrl    String?
  status      ProductStatus   @default(ACTIVE)
  featured    Boolean         @default(false)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime
  category    ProductCategory
  images      String[]
  metadata    String?
  shortDesc   String?
  stock       Int             @default(0)
  subcategory String?
  order_items order_items[]

  @@index([category])
  @@index([featured])
  @@index([slug])
}

model reading_progress {
  id           String   @id
  userId       String
  articleId    String
  articleTitle String
  articleUrl   String
  progress     Int
  completed    Boolean  @default(false)
  lastReadAt   DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  users        users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, articleId])
  @@index([completed])
  @@index([userId])
}

model seo_settings {
  id                         String   @id
  siteTitle                  String   @default("SUCCESS Magazine")
  siteDescription            String   @default("Your Guide to Personal and Professional Growth")
  siteKeywords               String   @default("success, business, entrepreneurship, leadership, personal development")
  ogImage                    String   @default("https://www.success.com/og-image.jpg")
  ogType                     String   @default("website")
  twitterHandle              String   @default("@successmagazine")
  twitterCardType            String   @default("summary_large_image")
  googleAnalyticsId          String?
  googleSearchConsoleCode    String?
  bingWebmasterCode          String?
  facebookDomainVerification String?
  sitemapUrl                 String   @default("/api/sitemap.xml")
  robotsTxt                  String   @default("User-agent: *\nAllow: /")
  canonicalUrl               String?
  hreflangTags               String?
  schemaOrgMarkup            String?
  headerScripts              String?
  footerScripts              String?
  faviconUrl                 String?
  appleTouchIconUrl          String?
  createdAt                  DateTime @default(now())
  updatedAt                  DateTime
}

model sessions {
  id           String   @id
  userId       String
  sessionToken String   @unique
  expires      DateTime
  ipAddress    String?
  userAgent    String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  users        users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([sessionToken])
  @@index([userId])
}

model site_settings {
  id                     String   @id
  siteName               String   @default("SUCCESS Magazine")
  siteDescription        String?
  siteUrl                String?
  adminEmail             String?
  facebookUrl            String?
  twitterUrl             String?
  instagramUrl           String?
  linkedinUrl            String?
  youtubeUrl             String?
  wordpressApiUrl        String?
  wordpressApiKey        String?
  defaultMetaTitle       String?
  defaultMetaDescription String?
  googleAnalyticsId      String?
  facebookPixelId        String?
  createdAt              DateTime @default(now())
  updatedAt              DateTime
}

model subscriptions {
  id                         String                  @id
  userId                     String?                 @unique
  stripeCustomerId           String?                 @unique
  stripeSubscriptionId       String?                 @unique
  stripePriceId              String?
  paykickstartCustomerId     String?                 @unique
  paykickstartSubscriptionId String?                 @unique
  provider                   String                  @default("stripe")
  currentPeriodStart         DateTime?
  currentPeriodEnd           DateTime?
  cancelAtPeriodEnd          Boolean                 @default(false)
  createdAt                  DateTime                @default(now())
  updatedAt                  DateTime
  billingCycle               String?
  tier                       String?
  status                     String                  @default("inactive")
  magazine_subscriptions     magazine_subscriptions?
  users                      users?                  @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([paykickstartCustomerId])
  @@index([paykickstartSubscriptionId])
  @@index([provider])
}

model tags {
  id        String   @id
  name      String
  slug      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime
  posts     posts[]  @relation("PostTags")

  @@index([slug])
}

model url_redirects {
  id         String   @id
  oldUrl     String   @unique
  newUrl     String
  statusCode Int      @default(301)
  hits       Int      @default(0)
  isActive   Boolean  @default(true)
  createdAt  DateTime @default(now())
  updatedAt  DateTime

  @@index([isActive])
  @@index([oldUrl])
}

model user_activities {
  id           String       @id
  userId       String
  activityType ActivityType
  title        String
  description  String?
  metadata     String?
  createdAt    DateTime     @default(now())
  users        users        @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([activityType])
  @@index([createdAt])
  @@index([userId])
}

model users {
  id                        String               @id
  name                      String
  email                     String               @unique
  password                  String
  role                      UserRole             @default(EDITOR)
  bio                       String?
  avatar                    String?
  createdAt                 DateTime             @default(now())
  updatedAt                 DateTime             @updatedAt
  stripeCustomerId          String?              @unique
  subscriptionStatus        SubscriptionStatus   @default(INACTIVE)
  subscriptionExpiry        DateTime?
  lastLoginAt               DateTime?
  emailVerified             Boolean              @default(false)
  emailVerificationToken    String?
  resetToken                String?
  resetTokenExpiry          DateTime?
  hasChangedDefaultPassword Boolean              @default(false)
  invitedBy                 String?
  inviteCode                String?
  membershipTier            MembershipTier       @default(FREE)
  wordpressId               Int?                 @unique
  socialTwitter             String?
  socialLinkedin            String?
  socialFacebook            String?
  website                   String?
  jobTitle                  String?
  authorPageSlug            String?              @unique
  onboardingCompleted       Boolean              @default(false)
  interests                 String[]
  activity_logs             activity_logs[]
  bookmarks                 bookmarks[]
  bulk_actions              bulk_actions[]
  editorial_calendar        editorial_calendar[]
  posts                     posts[]
  reading_progress          reading_progress[]
  sessions                  sessions[]
  subscriptions             subscriptions?
  user_activities           user_activities[]
  pay_links                 pay_links[]
  assigned_projects         projects[]           @relation("AssignedProjects")
  created_projects          projects[]           @relation("CreatedProjects")
  course_enrollments        course_enrollments[]
  staff_departments         staff_departments[]

  @@index([email])
  @@index([subscriptionStatus])
  @@index([inviteCode])
  @@index([wordpressId])
  @@index([authorPageSlug])
}

model invite_codes {
  id        String    @id
  code      String    @unique
  email     String?
  role      UserRole  @default(EDITOR)
  createdBy String
  usedBy    String?
  usedAt    DateTime?
  expiresAt DateTime
  maxUses   Int       @default(1)
  uses      Int       @default(0)
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now())

  @@index([code])
  @@index([isActive])
}

model videos {
  id          String     @id
  title       String
  slug        String     @unique
  description String?
  videoUrl    String
  thumbnail   String?
  duration    Int?
  status      PostStatus @default(DRAFT)
  publishedAt DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  wordpressId Int?       @unique

  @@index([slug])
  @@index([wordpressId])
}

model press_releases {
  id             String     @id @default(uuid())
  title          String
  slug           String     @unique
  content        String
  excerpt        String?
  featuredImage  String?
  status         PostStatus @default(DRAFT)
  publishedAt    DateTime?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime   @updatedAt
  seoTitle       String?
  seoDescription String?
  wordpressId    Int?       @unique

  @@index([slug])
  @@index([publishedAt])
  @@index([wordpressId])
}

model wordpress_migration {
  id           String   @id @default(uuid())
  contentType  String
  wordpressId  Int
  localId      String
  migratedAt   DateTime @default(now())
  status       String   @default("completed")
  errorMessage String?

  @@unique([contentType, wordpressId])
  @@index([contentType])
  @@index([status])
}

model projects {
  id           String        @id @default(uuid())
  title        String
  description  String?
  status       ProjectStatus @default(BACKLOG)
  assignedToId String?
  priority     Priority      @default(MEDIUM)
  dueDate      DateTime?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  createdBy    String
  order        Int           @default(0)
  tags         String[]
  notes        String?
  users        users?        @relation("AssignedProjects", fields: [assignedToId], references: [id], onDelete: SetNull)
  creator      users         @relation("CreatedProjects", fields: [createdBy], references: [id], onDelete: Cascade)

  @@index([status])
  @@index([assignedToId])
  @@index([createdBy])
  @@index([priority])
  @@index([dueDate])
}

enum ActivityType {
  ARTICLE_READ
  ARTICLE_BOOKMARKED
  VIDEO_WATCHED
  PODCAST_LISTENED
  ACHIEVEMENT_UNLOCKED
  SUBSCRIPTION_STARTED
}

enum BillingCycle {
  MONTHLY
  ANNUAL
}

enum BulkStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum CampaignStatus {
  DRAFT
  SCHEDULED
  SENDING
  SENT
  PAUSED
}

enum CommentStatus {
  PENDING
  APPROVED
  SPAM
  TRASH
}

enum ContactStatus {
  ACTIVE
  UNSUBSCRIBED
  BOUNCED
  SPAM
}

enum ContentType {
  ARTICLE
  VIDEO
  PODCAST
  MAGAZINE
  PAGE
  NEWSLETTER
}

enum EditorialStatus {
  IDEA
  ASSIGNED
  IN_PROGRESS
  DRAFT
  IN_REVIEW
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

enum MembershipTier {
  FREE
  INSIDER
  COLLECTIVE
}

enum OrderStatus {
  PENDING
  PROCESSING
  COMPLETED
  SHIPPED
  CANCELED
  REFUNDED
  FAILED
}

enum PostStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum Priority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

enum ProductCategory {
  BOOKS
  COURSES
  MERCHANDISE
  MAGAZINES
  BUNDLES
  MEMBERSHIPS
}

enum ProductStatus {
  DRAFT
  PUBLISHED
  OUT_OF_STOCK
  ARCHIVED
  ACTIVE
  DISCONTINUED
}

enum SubscriberStatus {
  ACTIVE
  UNSUBSCRIBED
  BOUNCED
}

enum SubscriptionStatus {
  ACTIVE
  INACTIVE
  PAST_DUE
  CANCELED
  TRIALING
}

enum UserRole {
  SUPER_ADMIN
  ADMIN
  EDITOR
  AUTHOR
}

enum Department {
  SUPER_ADMIN
  CUSTOMER_SERVICE
  EDITORIAL
  SUCCESS_PLUS
  DEV
  MARKETING
  COACHING
}

enum PayLinkStatus {
  ACTIVE
  INACTIVE
  EXPIRED
  ARCHIVED
}

enum ProjectStatus {
  BACKLOG
  TODO
  IN_PROGRESS
  REVIEW
  DONE
}

model courses {
  id              String               @id @default(uuid())
  title           String
  slug            String               @unique
  description     String?
  thumbnail       String?
  instructorName  String?
  instructorBio   String?
  instructorImage String?
  duration        Int? // in minutes
  level           CourseLevel          @default(BEGINNER)
  category        String?
  isPremium       Boolean              @default(true)
  isPublished     Boolean              @default(false)
  order           Int                  @default(0)
  createdAt       DateTime             @default(now())
  updatedAt       DateTime             @updatedAt
  modules         course_modules[]
  enrollments     course_enrollments[]

  @@index([slug])
  @@index([isPremium])
  @@index([isPublished])
}

model course_modules {
  id          String           @id @default(uuid())
  courseId    String
  title       String
  description String?
  order       Int
  duration    Int? // in minutes
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
  course      courses          @relation(fields: [courseId], references: [id], onDelete: Cascade)
  lessons     course_lessons[]

  @@index([courseId])
  @@index([order])
}

model course_lessons {
  id          String            @id @default(uuid())
  moduleId    String
  title       String
  description String?
  videoUrl    String?
  content     String?
  duration    Int? // in minutes
  order       Int
  isFree      Boolean           @default(false)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  module      course_modules    @relation(fields: [moduleId], references: [id], onDelete: Cascade)
  progress    lesson_progress[]

  @@index([moduleId])
  @@index([order])
}

model course_enrollments {
  id             String    @id @default(uuid())
  userId         String
  courseId       String
  progress       Int       @default(0) // percentage
  completedAt    DateTime?
  lastAccessedAt DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  users          users     @relation(fields: [userId], references: [id], onDelete: Cascade)
  course         courses   @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([userId, courseId])
  @@index([userId])
  @@index([courseId])
}

model lesson_progress {
  id            String         @id @default(uuid())
  userId        String
  lessonId      String
  completed     Boolean        @default(false)
  progress      Int            @default(0) // percentage for video
  watchTime     Int            @default(0) // in seconds
  lastWatchedAt DateTime?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  lesson        course_lessons @relation(fields: [lessonId], references: [id], onDelete: Cascade)

  @@unique([userId, lessonId])
  @@index([userId])
  @@index([lessonId])
}

model resources {
  id          String           @id @default(uuid())
  title       String
  description String?
  category    ResourceCategory
  fileUrl     String
  fileType    String
  fileSize    Int?
  thumbnail   String?
  isPremium   Boolean          @default(true)
  downloads   Int              @default(0)
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  @@index([category])
  @@index([isPremium])
}

model success_labs {
  id          String   @id @default(uuid())
  title       String
  slug        String   @unique
  description String?
  category    String?
  thumbnail   String?
  toolUrl     String
  isPremium   Boolean  @default(true)
  isActive    Boolean  @default(true)
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([slug])
  @@index([isPremium])
  @@index([isActive])
}

model events {
  id               String                @id @default(uuid())
  title            String
  slug             String                @unique
  description      String?
  eventType        EventType             @default(WEBINAR)
  startDateTime    DateTime
  endDateTime      DateTime?
  timezone         String                @default("America/New_York")
  location         String? // For virtual events, this could be the meeting link
  thumbnail        String?
  hostName         String?
  hostBio          String?
  hostImage        String?
  isPremium        Boolean               @default(true)
  maxAttendees     Int?
  currentAttendees Int                   @default(0)
  isPublished      Boolean               @default(false)
  createdAt        DateTime              @default(now())
  updatedAt        DateTime              @updatedAt
  registrations    event_registrations[]

  @@index([slug])
  @@index([startDateTime])
  @@index([isPremium])
  @@index([isPublished])
}

model event_registrations {
  id           String                  @id @default(uuid())
  userId       String
  eventId      String
  status       EventRegistrationStatus @default(REGISTERED)
  attended     Boolean                 @default(false)
  registeredAt DateTime                @default(now())
  canceledAt   DateTime?
  event        events                  @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@unique([userId, eventId])
  @@index([userId])
  @@index([eventId])
  @@index([status])
}

model magazine_progress {
  id          String   @id @default(uuid())
  userId      String
  magazineId  String
  currentPage Int      @default(1)
  totalPages  Int
  completed   Boolean  @default(false)
  lastReadAt  DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([userId, magazineId])
  @@index([userId])
  @@index([magazineId])
}

enum CourseLevel {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  ALL_LEVELS
}

enum ResourceCategory {
  TEMPLATES
  GUIDES
  WORKSHEETS
  EBOOKS
  TOOLS
  CHECKLISTS
}

enum EventType {
  WEBINAR
  WORKSHOP
  QA_SESSION
  NETWORKING
  MASTERCLASS
  CONFERENCE
}

enum EventRegistrationStatus {
  REGISTERED
  WAITLISTED
  CANCELED
  ATTENDED
}

model staff_departments {
  id         String     @id @default(uuid())
  userId     String
  department Department
  assignedBy String // User ID of Super Admin who assigned
  assignedAt DateTime   @default(now())
  user       users      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, department])
  @@index([userId])
  @@index([department])
}
